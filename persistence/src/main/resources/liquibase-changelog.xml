<!--
    Copyright (c) 2015 Development Gateway, Inc and others.

    All rights reserved. This program and the accompanying materials
    are made available under the terms of the MIT License (MIT)
    which accompanies this distribution, and is available at
    https://opensource.org/licenses/MIT

    Contributors:
    Development Gateway - initial API and implementation
-->
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
    
    <changeSet id="AD3-26" author="Octavian Ciubotaru">
        <preConditions onFail="CONTINUE">
            <tableExists tableName="person" />
            <columnExists tableName="person" columnName="organization_id" />
            <tableExists tableName="role" />
            <tableExists tableName="person_roles" />
            <tableExists tableName="category" />
        </preConditions>
        <insert tableName="category">
            <column name="id" valueSequenceNext="hibernate_sequence" />
            <column name="dtype" value="Organization" />
            <column name="label" value="FAO" />
        </insert>
        <insert tableName="person">
            <column name="id" valueSequenceNext="hibernate_sequence" />
            <column name="username" value="admin" />
            <column name="email" value="admin@developmentgateway.org" />
            <column name="enabled" value="true" />
            <column name="password" value="$2a$10$BTYSCSAFdv8K31CsY8RnN.FsJHp8xcUcMxWvf2L7QR3.C2hP02cQe" />
        </insert>
        <insert tableName="person">
            <column name="id" valueSequenceNext="hibernate_sequence" />
            <column name="username" value="fao" />
            <column name="email" value="fao@developmentgateway.org" />
            <column name="enabled" value="true" />
            <column name="password" value="$2a$10$BTYSCSAFdv8K31CsY8RnN.FsJHp8xcUcMxWvf2L7QR3.C2hP02cQe" />
        </insert>
        <insert tableName="role">
            <column name="id" valueSequenceNext="hibernate_sequence" />
            <column name="authority" value="ROLE_ADMIN" />
        </insert>
        <insert tableName="role">
            <column name="id" valueSequenceNext="hibernate_sequence" />
            <column name="authority" value="ROLE_FOCAL_POINT" />
        </insert>
        <sql><![CDATA[
            INSERT INTO person_roles(person_id, roles_id)
            SELECT p.id, r.id
            FROM person p,
                 role r
            WHERE p.username = 'admin'
              AND r.authority = 'ROLE_ADMIN';
        ]]></sql>
        <sql><![CDATA[
            INSERT INTO person_roles(person_id, roles_id)
            SELECT p.id, r.id
            FROM person p,
                 role r
            WHERE p.username = 'fao'
              AND r.authority = 'ROLE_FOCAL_POINT';
        ]]></sql>
        <sql><![CDATA[
            UPDATE person
            SET organization_id=org.id
            FROM category org
            WHERE person.username = 'fao'
              AND org.dtype = 'Organization'
              AND org.label = 'FAO';
        ]]></sql>
    </changeSet>

    <changeSet id="regionInsert" author="Daniel Oliva">
        <preConditions onFail="CONTINUE">
            <tableExists tableName="region" />
            <tableExists tableName="department" />
            <tableExists tableName="market" />
        </preConditions>
        <sql><![CDATA[
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Dakar', 'DK');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Diourbel', 'DL');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Fatick', 'FK');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Kaolack', 'KL');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Kolda', 'KD');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Louga', 'LG');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Matam', 'MT');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Saint-Louis', 'SL');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Tambacounda', 'TC');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Thiès', 'TH');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Ziguinchor', 'ZG');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Kaffrine', 'KF');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Kédougou', 'KG');
            insert into region(id, name, code) values (nextval('hibernate_sequence'), 'Sédhiou', 'SD');

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Dakar' from region where name='Dakar';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Guédiawaye' from region where name='Dakar';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Pikine' from region where name='Dakar';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Rufisque' from region where name='Dakar';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Bambey' from region where name='Diourbel';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Diourbel' from region where name='Diourbel';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Mbacké' from region where name='Diourbel';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Fatick' from region where name='Fatick';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Foundiougne' from region where name='Fatick';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Gossas' from region where name='Fatick';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Kaolack' from region where name='Kaolack';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Guinguinéo' from region where name='Kaolack';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Nioro du Rip' from region where name='Kaolack';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Kolda' from region where name='Kolda';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Vélingara' from region where name='Kolda';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Médina Yoro Foulah' from region where name='Kolda';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Kébémer' from region where name='Louga';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Linguère' from region where name='Louga';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Louga' from region where name='Louga';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Kanel' from region where name='Matam';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Matam' from region where name='Matam';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Ranérou' from region where name='Matam';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Dagana' from region where name='Saint-Louis';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Podor' from region where name='Saint-Louis';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Saint-Louis' from region where name='Saint-Louis';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Bakel' from region where name='Tambacounda';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Koumpentoum' from region where name='Tambacounda';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Tambacounda' from region where name='Tambacounda';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Goudiry' from region where name='Tambacounda';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'M''bour' from region where name='Thiès';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Thiès' from region where name='Thiès';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Tivaouane' from region where name='Thiès';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Bignona' from region where name='Ziguinchor';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Oussouye' from region where name='Ziguinchor';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Ziguinchor' from region where name='Ziguinchor';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Birkilane' from region where name='Kaffrine';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Kaffrine' from region where name='Kaffrine';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Malem-Hodar' from region where name='Kaffrine';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Kounghel' from region where name='Kaffrine';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Kédougou' from region where name='Kédougou';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Salemata' from region where name='Kédougou';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Saraya' from region where name='Kédougou';

            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Bounkiling' from region where name='Sédhiou';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Goudomp' from region where name='Sédhiou';
            insert into department(id, region_id, name) select nextval('hibernate_sequence'),id,'Sédhiou' from region where name='Sédhiou';

            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Bignona' from department where name='Bignona';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Birkilane' from department where name='Birkilane';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Touba Mouride' from department where name='Bounkiling';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Tilene' from department where name='Dakar';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Diourbel' from department where name='Diourbel';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Fatick' from department where name='Fatick';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Passy' from department where name='Foundiougne';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Kaffrine' from department where name='Kaffrine';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Thiodaye' from department where name='Kanel';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Kaolack' from department where name='Kaolack';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Kolda' from department where name='Kolda';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Mereto' from department where name='Koumpentoum';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Kédougou' from department where name='Kédougou';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Mako' from department where name='Kédougou';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Gouille Mbeuth' from department where name='Louga';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Louga' from department where name='Louga';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Ourossogui' from department where name='Matam';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Thiodaye' from department where name='Matam';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Touba' from department where name='Mbacké';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Porokhane' from department where name='Nioro du Rip';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Thiaroye' from department where name='Pikine';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Mpal' from department where name='Saint-Louis';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Saint-Louis' from department where name='Saint-Louis';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Sédhiou' from department where name='Sédhiou';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Tambacounda' from department where name='Tambacounda';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Thiès' from department where name='Thiès';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Touba Toul' from department where name='Thiès';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Diaobe' from department where name='Vélingara';
            insert into market(id, department_id, name) select nextval('hibernate_sequence'),id,'Saint-Maur' from department where name='Ziguinchor';
        ]]></sql>
    </changeSet>

    <changeSet id="AD3-53: crop types" author="Octavian Ciubotaru">
        <preConditions onFail="CONTINUE">
            <tableExists tableName="category" />
            <tableExists tableName="localized_category_label" />
        </preConditions>
        <sql><![CDATA[
            INSERT INTO category (dtype, id, label) VALUES ('CropType', nextval('hibernate_sequence'), 'Corn');
            INSERT INTO category (dtype, id, label) VALUES ('CropType', nextval('hibernate_sequence'), 'Imported Corn');
            INSERT INTO category (dtype, id, label) VALUES ('CropType', nextval('hibernate_sequence'), 'Millet');
            INSERT INTO category (dtype, id, label) VALUES ('CropType', nextval('hibernate_sequence'), 'Rice');
            INSERT INTO category (dtype, id, label) VALUES ('CropType', nextval('hibernate_sequence'), 'Imported Rice');
            INSERT INTO category (dtype, id, label) VALUES ('CropType', nextval('hibernate_sequence'), 'Imported Scented Rice');
            INSERT INTO category (dtype, id, label) VALUES ('CropType', nextval('hibernate_sequence'), 'Sorghum');
            INSERT INTO category (dtype, id, label) VALUES ('CropType', nextval('hibernate_sequence'), 'Imported Sorghum');

            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Maïs','fr',id FROM category WHERE label='Corn' AND dtype='CropType';
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Maïs Importé','fr',id FROM category WHERE label='Imported Corn' AND dtype='CropType';
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Millet','fr',id FROM category WHERE label='Millet' AND dtype='CropType';
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Riz','fr',id FROM category WHERE label='Rice' AND dtype='CropType';
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Riz Importé','fr',id FROM category WHERE label='Imported Rice' AND dtype='CropType';
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Riz Importé Parfumé','fr',id FROM category WHERE label='Imported Scented Rice' AND dtype='CropType';
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Sorgho','fr',id FROM category WHERE label='Sorghum' AND dtype='CropType';
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Sorgho Importé','fr',id FROM category WHERE label='Imported Sorghum' AND dtype='CropType';
        ]]></sql>
    </changeSet>

    <changeSet id="Gender and Age Groups" author="Daniel Oliva">
        <preConditions onFail="CONTINUE">
            <tableExists tableName="category" />
            <tableExists tableName="localized_category_label" />
        </preConditions>
        <sql><![CDATA[
            INSERT INTO category (dtype, id, label) VALUES ('AgriculturalWomenGroup', nextval('hibernate_sequence'), 'Age Group');
            INSERT INTO category (dtype, id, label) VALUES ('AgriculturalWomenGroup', nextval('hibernate_sequence'), 'Method of enforcement');
            INSERT INTO category (dtype, id, label) VALUES ('AgriculturalWomenGroup', nextval('hibernate_sequence'), 'Crop');

            INSERT INTO category (dtype, id, label) VALUES ('Gender', nextval('hibernate_sequence'), 'Male');
            INSERT INTO category (dtype, id, label) VALUES ('Gender', nextval('hibernate_sequence'), 'Female');
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Masculin','fr',id FROM category WHERE label='Male' AND dtype='Gender';
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Féminin','fr',id FROM category WHERE label='Female' AND dtype='Gender';

            INSERT INTO category (dtype, id, label) VALUES ('AgeGroup', nextval('hibernate_sequence'), 'Under 15');
            INSERT INTO category (dtype, id, label) VALUES ('AgeGroup', nextval('hibernate_sequence'), '15-25');
            INSERT INTO category (dtype, id, label) VALUES ('AgeGroup', nextval('hibernate_sequence'), '25-45');
            INSERT INTO category (dtype, id, label) VALUES ('AgeGroup', nextval('hibernate_sequence'), '45-65');
            INSERT INTO category (dtype, id, label) VALUES ('AgeGroup', nextval('hibernate_sequence'), 'Over 66');
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Moins de 15','fr',id FROM category WHERE label='Under 15' AND dtype='AgeGroup';
            INSERT INTO localized_category_label(id, label, language, category_id) SELECT nextval('hibernate_sequence'),'Plus de 66','fr',id FROM category WHERE label='Over 66' AND dtype='AgeGroup';

            INSERT INTO category (dtype, id, label) VALUES ('MethodOfEnforcement', nextval('hibernate_sequence'), 'Ownership');
            INSERT INTO category (dtype, id, label) VALUES ('MethodOfEnforcement', nextval('hibernate_sequence'), 'Undocumented ownership');
            INSERT INTO category (dtype, id, label) VALUES ('MethodOfEnforcement', nextval('hibernate_sequence'), 'Rent with agreement');
            INSERT INTO category (dtype, id, label) VALUES ('MethodOfEnforcement', nextval('hibernate_sequence'), 'Rent without agreement');
            INSERT INTO category (dtype, id, label) VALUES ('MethodOfEnforcement', nextval('hibernate_sequence'), 'Loan');
            INSERT INTO category (dtype, id, label) VALUES ('MethodOfEnforcement', nextval('hibernate_sequence'), 'Free Occupation or Occupation without authorization');

        ]]></sql>
    </changeSet>

</databaseChangeLog>
